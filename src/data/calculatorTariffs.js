/**
 * Calculator Tariff Data
 *
 * Condensed tariff data for the calculator, extracted from the 88-utility tariff database.
 * This file contains only the fields needed for calculations, with units converted for the calculator.
 *
 * Source: nextjs-app/lib/generatedTariffData.ts
 * Last Updated: 2026-01-01
 *
 * Unit conversions applied:
 * - Demand charges: $/kW-month → $/MW-month (×1000)
 * - Energy rates: $/kWh → $/MWh (×1000)
 */

// ISO-specific capacity costs ($/MW-year)
// Based on 2024-2025 capacity market prices
export const ISO_CAPACITY_COSTS = {
  'PJM': 98528,      // $269.92/MW-day × 365 (2024 BRA)
  'MISO': 10950,     // $30/MW-day × 365 (lower clearing prices)
  'NYISO': 65700,    // $180/MW-day × 365 (mid-range)
  'ISO-NE': 54750,   // $150/MW-day × 365 (FCM)
  'CAISO': 27375,    // $75/MW-day × 365 (resource adequacy)
  'ERCOT': 0,        // No capacity market (energy-only)
  'SPP': 0,          // No mandatory capacity market
  'None': 50000,     // Regulated utility embedded cost estimate
};

// ERCOT 4CP transmission rate ($/kW per peak)
// Total annual cost is based on contribution to 4 summer peak intervals
export const ERCOT_4CP_RATE = 5.50; // $/kW per CP contribution

/**
 * Condensed tariff data for all 88 utilities
 * Key fields for calculations with units converted
 */
export const CALCULATOR_TARIFFS = {
  // =============================================
  // SORTED BY BLENDED RATE (LOWEST TO HIGHEST)
  // =============================================

  'tva-tn': {
    id: 'tva-tn',
    utility: 'TVA',
    utilityShort: 'TVA',
    state: 'TN/AL/KY/MS',
    region: 'Southeast',
    isoRto: 'None',
    tariffName: 'General Service Rate',
    rateSchedule: 'GSA Part 3',
    effectiveDate: '2024-10-01',
    // Demand charges ($/MW-month)
    peakDemandCharge: 5340,
    offPeakDemandCharge: 2500,
    // Energy rates ($/MWh)
    energyRatePeak: 24.5,
    energyRateOffPeak: 18.5,
    // Blended rate ($/MWh)
    blendedRate: 47.18,
    // Fuel adjustment ($/MWh)
    fuelAdjustment: 15.0,
    // Contract terms
    initialTermYears: 5,
    // Protection score (0-26)
    protectionScore: 6,
    protectionRating: 'Low',
    // Key protections
    minimumDemandPct: 60,
    demandRatchetPct: 60,
    takeOrPay: false,
    notes: 'Federal power agency; lowest rates in Southeast',
  },

  'public-service-company-of-oklahoma-pso-ok': {
    id: 'public-service-company-of-oklahoma-pso-ok',
    utility: 'Public Service Company of Oklahoma (PSO)',
    utilityShort: 'PSO Oklahoma',
    state: 'OK',
    region: 'Plains',
    isoRto: 'SPP',
    tariffName: 'Large Power & Light (LPL)',
    rateSchedule: 'Schedule 242/244/246',
    effectiveDate: '2025-01-30',
    peakDemandCharge: 7050,
    offPeakDemandCharge: 2470,
    energyRatePeak: 1.71,
    energyRateOffPeak: 1.25,
    blendedRate: 50.62,
    fuelAdjustment: 35.0,
    initialTermYears: 7,
    protectionScore: 12,
    protectionRating: 'Mid',
    minimumDemandPct: 90,
    demandRatchetPct: 90,
    takeOrPay: false,
    notes: '11 large load customers (779 MW)',
  },

  'nebraska-public-power-district-ne': {
    id: 'nebraska-public-power-district-ne',
    utility: 'Nebraska Public Power District',
    utilityShort: 'NPPD Nebraska',
    state: 'NE',
    region: 'Plains',
    isoRto: 'SPP',
    tariffName: 'Large Power Service',
    rateSchedule: 'Schedule LP',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 5800,
    offPeakDemandCharge: 2200,
    energyRatePeak: 35.0,
    energyRateOffPeak: 25.0,
    blendedRate: 52.82,
    fuelAdjustment: 12.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Public power district',
  },

  'dominion-energy-virginia-va': {
    id: 'dominion-energy-virginia-va',
    utility: 'Dominion Energy Virginia',
    utilityShort: 'Dominion Virginia',
    state: 'VA',
    region: 'Mid-Atlantic',
    isoRto: 'PJM',
    tariffName: 'Large General Service TOU',
    rateSchedule: 'Schedule GS-4',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 8770,
    offPeakDemandCharge: 520,
    energyRatePeak: 27.0,
    energyRateOffPeak: 18.0,
    blendedRate: 55.06,
    fuelAdjustment: 18.0,
    initialTermYears: 14,
    protectionScore: 15,
    protectionRating: 'High',
    minimumDemandPct: 85,
    demandRatchetPct: 85,
    takeOrPay: true,
    notes: 'Data center capital; 14-year contract required',
  },

  'oppd-omaha-public-power-ne': {
    id: 'oppd-omaha-public-power-ne',
    utility: 'OPPD (Omaha Public Power)',
    utilityShort: 'OPPD Omaha',
    state: 'NE',
    region: 'Plains',
    isoRto: 'SPP',
    tariffName: 'Large Power',
    rateSchedule: 'Rate 261',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 6200,
    offPeakDemandCharge: 2400,
    energyRatePeak: 38.0,
    energyRateOffPeak: 28.0,
    blendedRate: 56.67,
    fuelAdjustment: 12.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Omaha metro',
  },

  'midamerican-energy-ia': {
    id: 'midamerican-energy-ia',
    utility: 'MidAmerican Energy',
    utilityShort: 'MidAmerican Iowa',
    state: 'IA',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 6800,
    offPeakDemandCharge: 2500,
    energyRatePeak: 38.0,
    energyRateOffPeak: 28.0,
    blendedRate: 57.78,
    fuelAdjustment: 12.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'BHE subsidiary; wind-heavy portfolio',
  },

  'oklahoma-gas-and-electric-ogande-ok': {
    id: 'oklahoma-gas-and-electric-ogande-ok',
    utility: 'Oklahoma Gas & Electric (OG&E)',
    utilityShort: 'OG&E Oklahoma',
    state: 'OK',
    region: 'Plains',
    isoRto: 'SPP',
    tariffName: 'Power & Light Large',
    rateSchedule: 'Schedule PL-1',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 7080,
    offPeakDemandCharge: 2500,
    energyRatePeak: 7.0,
    energyRateOffPeak: 5.0,
    blendedRate: 58.06,
    fuelAdjustment: 38.0,
    initialTermYears: 5,
    protectionScore: 5,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Large load tariff filing required by July 2026',
  },

  'black-hills-energy-wy-wy': {
    id: 'black-hills-energy-wy-wy',
    utility: 'Black Hills Energy (WY)',
    utilityShort: 'Black Hills WY',
    state: 'WY',
    region: 'Mountain West',
    isoRto: 'None',
    tariffName: 'Large Power Contract',
    rateSchedule: 'Schedule LPC',
    effectiveDate: '2019-01-01',
    peakDemandCharge: 5500,
    offPeakDemandCharge: 2200,
    energyRatePeak: 42.0,
    energyRateOffPeak: 32.0,
    blendedRate: 59.30,
    fuelAdjustment: 12.0,
    initialTermYears: 3,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: '13MW+ min; customer BTM required',
  },

  'dte-energy-mi': {
    id: 'dte-energy-mi',
    utility: 'DTE Energy',
    utilityShort: 'DTE Michigan',
    state: 'MI',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Primary Supply Agreement',
    rateSchedule: 'Schedule D11',
    effectiveDate: '2025-12-18',
    peakDemandCharge: 6320,
    offPeakDemandCharge: 1730,
    energyRatePeak: 38.0,
    energyRateOffPeak: 28.0,
    blendedRate: 59.30,
    fuelAdjustment: 15.0,
    initialTermYears: 19,
    protectionScore: 17,
    protectionRating: 'High',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: true,
    notes: 'Oracle/OpenAI 1.4GW facility (U-21990)',
  },

  'black-hills-energy-sd-sd': {
    id: 'black-hills-energy-sd-sd',
    utility: 'Black Hills Energy (SD)',
    utilityShort: 'Black Hills SD',
    state: 'SD',
    region: 'Mountain West',
    isoRto: 'None',
    tariffName: 'Blockchain/Economic Flexible Load',
    rateSchedule: 'BCIS Tariff (Docket EL25-019)',
    effectiveDate: '2026-01-28',
    peakDemandCharge: 0,
    offPeakDemandCharge: 0,
    energyRatePeak: 45.0,
    energyRateOffPeak: 45.0,
    blendedRate: 60.0,
    fuelAdjustment: 15.0,
    initialTermYears: 2,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'BCIS (Blockchain Interruptible Service) / EFLS; 15-min curtailment notice; Energy-only rate',
  },

  'ercot-market-via-rep-tx': {
    id: 'ercot-market-via-rep-tx',
    utility: 'ERCOT Market (via REP)',
    utilityShort: 'ERCOT Texas',
    state: 'TX',
    region: 'Texas',
    isoRto: 'ERCOT',
    tariffName: '4CP Transmission + REP Energy',
    rateSchedule: 'Market-Based',
    effectiveDate: '2024-01-01',
    peakDemandCharge: 5500,
    offPeakDemandCharge: 1500,
    energyRatePeak: 45.0,
    energyRateOffPeak: 28.0,
    blendedRate: 60.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 8,
    protectionRating: 'Mid',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Grid operator not retailer; 200+ GW in queue; 4CP transmission allocation',
    is4CP: true, // Special flag for ERCOT 4CP logic
  },

  'swepco-aep-tx': {
    id: 'swepco-aep-tx',
    utility: 'SWEPCO (AEP)',
    utilityShort: 'AEP SWEPCO',
    state: 'TX/LA/AR',
    region: 'Plains',
    isoRto: 'SPP',
    tariffName: 'Large Load Contract',
    rateSchedule: 'ES-LL Contract',
    effectiveDate: '2025-10-01',
    peakDemandCharge: 8200,
    offPeakDemandCharge: 3100,
    energyRatePeak: 35.0,
    energyRateOffPeak: 25.0,
    blendedRate: 60.70,
    fuelAdjustment: 15.0,
    initialTermYears: 12,
    protectionScore: 16,
    protectionRating: 'High',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: true,
    notes: 'Large load contract',
  },

  'duke-energy-carolinas-nc': {
    id: 'duke-energy-carolinas-nc',
    utility: 'Duke Energy Carolinas',
    utilityShort: 'Duke Carolinas',
    state: 'NC',
    region: 'Southeast',
    isoRto: 'None',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS',
    effectiveDate: '2024-09-01',
    peakDemandCharge: 5200,
    offPeakDemandCharge: 3500,
    energyRatePeak: 35.0,
    energyRateOffPeak: 28.0,
    blendedRate: 60.70,
    fuelAdjustment: 18.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: '42 GW in NC queue',
  },

  'evergy-kansasmissouri-ks': {
    id: 'evergy-kansasmissouri-ks',
    utility: 'Evergy (Kansas/Missouri)',
    utilityShort: 'Evergy KS/MO',
    state: 'KS/MO',
    region: 'Midwest',
    isoRto: 'SPP',
    tariffName: 'Large Load Power Service',
    rateSchedule: 'Schedule LLPS',
    effectiveDate: '2025-11-06',
    peakDemandCharge: 7200,
    offPeakDemandCharge: 2800,
    energyRatePeak: 35.0,
    energyRateOffPeak: 25.0,
    blendedRate: 61.73,
    fuelAdjustment: 18.0,
    initialTermYears: 17,
    protectionScore: 17,
    protectionRating: 'High',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: true,
    notes: '5+12 year term (17 total)',
  },

  'northwestern-energy-sd-sd': {
    id: 'northwestern-energy-sd-sd',
    utility: 'NorthWestern Energy (SD)',
    utilityShort: 'NorthWestern SD',
    state: 'SD',
    region: 'Plains',
    isoRto: 'None',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS',
    effectiveDate: '2025-01-30',
    peakDemandCharge: 10750,
    offPeakDemandCharge: 5380,
    energyRatePeak: 24.2,
    energyRateOffPeak: 18.2,
    blendedRate: 62.61,
    fuelAdjustment: 19.0,
    initialTermYears: 5,
    protectionScore: 5,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: '',
  },

  'centerpoint-energy-houston-tx': {
    id: 'centerpoint-energy-houston-tx',
    utility: 'CenterPoint Energy Houston',
    utilityShort: 'CenterPoint Houston',
    state: 'TX',
    region: 'Texas',
    isoRto: 'ERCOT',
    tariffName: 'Large Volume + REP',
    rateSchedule: 'GSLV-630 + REP',
    effectiveDate: '2025-03-01',
    peakDemandCharge: 8800,
    offPeakDemandCharge: 3500,
    energyRatePeak: 40.0,
    energyRateOffPeak: 28.0,
    blendedRate: 62.87,
    fuelAdjustment: 12.0,
    initialTermYears: 5,
    protectionScore: 5,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Houston metro',
    is4CP: true,
  },

  'georgia-power-ga': {
    id: 'georgia-power-ga',
    utility: 'Georgia Power',
    utilityShort: 'Georgia Power',
    state: 'GA',
    region: 'Southeast',
    isoRto: 'None',
    tariffName: 'Power and Light Large',
    rateSchedule: 'Schedule PLL-11',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 9530,
    offPeakDemandCharge: 4200,
    energyRatePeak: 14.3,
    energyRateOffPeak: 9.5,
    blendedRate: 63.33,
    fuelAdjustment: 32.0,
    initialTermYears: 10,
    protectionScore: 14,
    protectionRating: 'High',
    minimumDemandPct: 95,
    demandRatchetPct: 95,
    takeOrPay: true,
    notes: '51 GW in queue; ECCR adds ~13.4%',
  },

  'ameren-missouri-mo': {
    id: 'ameren-missouri-mo',
    utility: 'Ameren Missouri',
    utilityShort: 'Ameren Missouri',
    state: 'MO',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Large Primary Service',
    rateSchedule: 'Schedule 11(M)',
    effectiveDate: '2025-12-04',
    peakDemandCharge: 8500,
    offPeakDemandCharge: 3200,
    energyRatePeak: 38.0,
    energyRateOffPeak: 28.0,
    blendedRate: 64.29,
    fuelAdjustment: 15.0,
    initialTermYears: 12,
    protectionScore: 16,
    protectionRating: 'High',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: true,
    notes: '75MW threshold; 36-month termination notice',
  },

  'northwestern-energy-mt-mt': {
    id: 'northwestern-energy-mt-mt',
    utility: 'NorthWestern Energy (MT)',
    utilityShort: 'NorthWestern MT',
    state: 'MT',
    region: 'West',
    isoRto: 'None',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS',
    effectiveDate: '2025-01-30',
    peakDemandCharge: 10950,
    offPeakDemandCharge: 5480,
    energyRatePeak: 24.8,
    energyRateOffPeak: 18.8,
    blendedRate: 64.64,
    fuelAdjustment: 20.0,
    initialTermYears: 5,
    protectionScore: 5,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: '',
  },

  'otter-tail-power-mn': {
    id: 'otter-tail-power-mn',
    utility: 'Otter Tail Power',
    utilityShort: 'Otter Tail MN',
    state: 'MN/ND/SD',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule 20',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 7500,
    offPeakDemandCharge: 2800,
    energyRatePeak: 42.0,
    energyRateOffPeak: 30.0,
    blendedRate: 65.04,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 5,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Rural utility; 3-state territory',
  },

  'aep-ohio-oh': {
    id: 'aep-ohio-oh',
    utility: 'AEP Ohio',
    utilityShort: 'AEP Ohio',
    state: 'OH',
    region: 'Midwest',
    isoRto: 'PJM',
    tariffName: 'Data Center Tariff (DCT)',
    rateSchedule: 'Schedule DCT',
    effectiveDate: '2025-07-23',
    peakDemandCharge: 6500,
    offPeakDemandCharge: 2000,
    energyRatePeak: 45.0,
    energyRateOffPeak: 32.0,
    blendedRate: 65.04,
    fuelAdjustment: 15.0,
    initialTermYears: 12,
    protectionScore: 16,
    protectionRating: 'High',
    minimumDemandPct: 85,
    demandRatchetPct: 85,
    takeOrPay: true,
    notes: 'DCT: Investment Grade OR Cash Collateral. Two-step queue: Load Study (45d) → ESA (60d).',
  },

  'ppl-electric-pa': {
    id: 'ppl-electric-pa',
    utility: 'PPL Electric',
    utilityShort: 'PPL Pennsylvania',
    state: 'PA',
    region: 'Mid-Atlantic',
    isoRto: 'PJM',
    tariffName: 'Large C&I Transmission',
    rateSchedule: 'Pa. P.U.C. No. 201',
    effectiveDate: '2025-06-01',
    peakDemandCharge: 7800,
    offPeakDemandCharge: 3200,
    energyRatePeak: 42.0,
    energyRateOffPeak: 30.0,
    blendedRate: 65.90,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 11,
    protectionRating: 'Mid',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: false,
    notes: 'PA PUC Model Tariff sets 5-year min',
  },

  'entergy-texas-tx': {
    id: 'entergy-texas-tx',
    utility: 'Entergy Texas',
    utilityShort: 'Entergy Texas',
    state: 'TX',
    region: 'Texas',
    isoRto: 'MISO',
    tariffName: 'Large Industrial Power',
    rateSchedule: 'Schedule LIP',
    effectiveDate: '2025-01-30',
    peakDemandCharge: 7200,
    offPeakDemandCharge: 2800,
    energyRatePeak: 42.0,
    energyRateOffPeak: 30.0,
    blendedRate: 66.50,
    fuelAdjustment: 18.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Part of MISO (not ERCOT)',
  },

  'entergy-louisiana-la': {
    id: 'entergy-louisiana-la',
    utility: 'Entergy Louisiana',
    utilityShort: 'Entergy Louisiana',
    state: 'LA',
    region: 'Southeast',
    isoRto: 'MISO',
    tariffName: 'Large Industrial Power',
    rateSchedule: 'Schedule LIP',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 7500,
    offPeakDemandCharge: 3000,
    energyRatePeak: 42.0,
    energyRateOffPeak: 30.0,
    blendedRate: 67.20,
    fuelAdjustment: 18.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'MISO South',
  },

  'arizona-public-service-aps-az': {
    id: 'arizona-public-service-aps-az',
    utility: 'Arizona Public Service (APS)',
    utilityShort: 'APS Arizona',
    state: 'AZ',
    region: 'Southwest',
    isoRto: 'None',
    tariffName: 'Large General Service TOU',
    rateSchedule: 'Schedule E-32',
    effectiveDate: '2024-06-01',
    peakDemandCharge: 9800,
    offPeakDemandCharge: 3200,
    energyRatePeak: 48.0,
    energyRateOffPeak: 28.0,
    blendedRate: 73.52,
    fuelAdjustment: 18.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 75,
    demandRatchetPct: 75,
    takeOrPay: false,
    notes: '40% peak growth to 13,000 MW by 2031',
  },

  'duke-energy-indiana-in': {
    id: 'duke-energy-indiana-in',
    utility: 'Duke Energy Indiana',
    utilityShort: 'Duke Indiana',
    state: 'IN',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule Rate 31',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 8200,
    offPeakDemandCharge: 3500,
    energyRatePeak: 45.0,
    energyRateOffPeak: 32.0,
    blendedRate: 70.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: 'MISO zone',
  },

  'aep-indiana-michigan-power-in': {
    id: 'aep-indiana-michigan-power-in',
    utility: 'AEP Indiana Michigan Power',
    utilityShort: 'AEP I&M',
    state: 'IN/MI',
    region: 'Midwest',
    isoRto: 'PJM',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS-T',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 8500,
    offPeakDemandCharge: 3500,
    energyRatePeak: 48.0,
    energyRateOffPeak: 35.0,
    blendedRate: 75.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: 'PJM zone; owns Cook Nuclear',
  },

  'nv-energy-nv': {
    id: 'nv-energy-nv',
    utility: 'NV Energy',
    utilityShort: 'NV Energy Nevada',
    state: 'NV',
    region: 'West',
    isoRto: 'None',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS-1',
    effectiveDate: '2024-07-01',
    peakDemandCharge: 8500,
    offPeakDemandCharge: 4200,
    energyRatePeak: 55.0,
    energyRateOffPeak: 35.0,
    blendedRate: 79.15,
    fuelAdjustment: 18.0,
    initialTermYears: 10,
    protectionScore: 16,
    protectionRating: 'High',
    minimumDemandPct: 80,
    demandRatchetPct: 80,
    takeOrPay: true,
    notes: '4+ GW AI DC projects in queue',
  },

  'xcel-energy-co-co': {
    id: 'xcel-energy-co-co',
    utility: 'Xcel Energy Colorado',
    utilityShort: 'Xcel Colorado',
    state: 'CO',
    region: 'Mountain West',
    isoRto: 'None',
    tariffName: 'Transmission General Service',
    rateSchedule: 'Schedule TG',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 9200,
    offPeakDemandCharge: 4000,
    energyRatePeak: 52.0,
    energyRateOffPeak: 38.0,
    blendedRate: 78.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: 'Data centers to drive 2/3 of new demand',
  },

  'aep-appalachian-power-va': {
    id: 'aep-appalachian-power-va',
    utility: 'AEP Appalachian Power',
    utilityShort: 'AEP Appalachian',
    state: 'VA/WV',
    region: 'Mid-Atlantic',
    isoRto: 'PJM',
    tariffName: 'Large General Service',
    rateSchedule: 'Schedule LGS',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 9500,
    offPeakDemandCharge: 4000,
    energyRatePeak: 55.0,
    energyRateOffPeak: 40.0,
    blendedRate: 82.00,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: 'Virginia portion seeing data center interest as NoVA constrained',
  },

  'novec-va': {
    id: 'novec-va',
    utility: 'NOVEC',
    utilityShort: 'NOVEC Virginia',
    state: 'VA',
    region: 'Mid-Atlantic',
    isoRto: 'PJM',
    tariffName: 'Data Center Service',
    rateSchedule: 'Schedule DCS',
    effectiveDate: '2024-01-01',
    peakDemandCharge: 10500,
    offPeakDemandCharge: 4500,
    energyRatePeak: 58.0,
    energyRateOffPeak: 42.0,
    blendedRate: 85.00,
    fuelAdjustment: 15.0,
    initialTermYears: 20,
    protectionScore: 18,
    protectionRating: 'High',
    minimumDemandPct: 90,
    demandRatchetPct: 90,
    takeOrPay: true,
    notes: 'Dedicated data center rate; 20-year term',
  },

  // Additional utilities (abbreviated entries)
  'consumers-energy-mi': {
    id: 'consumers-energy-mi',
    utility: 'Consumers Energy',
    utilityShort: 'Consumers MI',
    state: 'MI',
    region: 'Midwest',
    isoRto: 'MISO',
    tariffName: 'Large General Service Primary',
    rateSchedule: 'Rate GPD',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 7800,
    offPeakDemandCharge: 3200,
    energyRatePeak: 45.0,
    energyRateOffPeak: 32.0,
    blendedRate: 68.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 6,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Western Michigan',
  },

  'alabama-power-al': {
    id: 'alabama-power-al',
    utility: 'Alabama Power',
    utilityShort: 'Alabama Power',
    state: 'AL',
    region: 'Southeast',
    isoRto: 'None',
    tariffName: 'Large Power TOU',
    rateSchedule: 'Schedule LPM',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 8800,
    offPeakDemandCharge: 3800,
    energyRatePeak: 38.0,
    energyRateOffPeak: 28.0,
    blendedRate: 67.50,
    fuelAdjustment: 22.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 60,
    demandRatchetPct: 60,
    takeOrPay: false,
    notes: 'Southern Company subsidiary',
  },

  'florida-power-and-light-fpl-fl': {
    id: 'florida-power-and-light-fpl-fl',
    utility: 'Florida Power & Light (FPL)',
    utilityShort: 'FPL Florida',
    state: 'FL',
    region: 'Southeast',
    isoRto: 'None',
    tariffName: 'General Service Demand Large',
    rateSchedule: 'Schedule GSLD-1',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 12500,
    offPeakDemandCharge: 5500,
    energyRatePeak: 65.0,
    energyRateOffPeak: 45.0,
    blendedRate: 95.00,
    fuelAdjustment: 25.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 60,
    demandRatchetPct: 60,
    takeOrPay: false,
    notes: 'Largest utility in FL',
  },

  'comed-exelon-il': {
    id: 'comed-exelon-il',
    utility: 'ComEd (Exelon)',
    utilityShort: 'ComEd Illinois',
    state: 'IL',
    region: 'Midwest',
    isoRto: 'PJM',
    tariffName: 'High Voltage Delivery Class',
    rateSchedule: 'Rate HVDC',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 10500,
    offPeakDemandCharge: 4500,
    energyRatePeak: 58.0,
    energyRateOffPeak: 42.0,
    blendedRate: 88.50,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 70,
    demandRatchetPct: 70,
    takeOrPay: false,
    notes: 'Chicago metro; PJM ComEd zone',
  },

  'pacific-gas-and-electric-pgande-ca': {
    id: 'pacific-gas-and-electric-pgande-ca',
    utility: 'Pacific Gas & Electric (PG&E)',
    utilityShort: 'PG&E California',
    state: 'CA',
    region: 'West',
    isoRto: 'CAISO',
    tariffName: 'Large Power',
    rateSchedule: 'Schedule E-20',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 22000,
    offPeakDemandCharge: 8500,
    energyRatePeak: 120.0,
    energyRateOffPeak: 75.0,
    blendedRate: 180.00,
    fuelAdjustment: 25.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Highest rates in continental US',
  },

  'southern-california-edison-sce-ca': {
    id: 'southern-california-edison-sce-ca',
    utility: 'Southern California Edison (SCE)',
    utilityShort: 'SCE California',
    state: 'CA',
    region: 'West',
    isoRto: 'CAISO',
    tariffName: 'TOU-8 Option B',
    rateSchedule: 'Schedule TOU-8-B',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 25000,
    offPeakDemandCharge: 10000,
    energyRatePeak: 150.0,
    energyRateOffPeak: 95.0,
    blendedRate: 200.00,
    fuelAdjustment: 20.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Second highest rates in US',
  },

  'conedison-ny': {
    id: 'conedison-ny',
    utility: 'Con Edison',
    utilityShort: 'ConEd New York',
    state: 'NY',
    region: 'Northeast',
    isoRto: 'NYISO',
    tariffName: 'SC 9 - General Large',
    rateSchedule: 'Service Classification 9',
    effectiveDate: '2025-01-01',
    peakDemandCharge: 28000,
    offPeakDemandCharge: 12000,
    energyRatePeak: 180.0,
    energyRateOffPeak: 120.0,
    blendedRate: 195.00,
    fuelAdjustment: 25.0,
    initialTermYears: 5,
    protectionScore: 7,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'NYC metro; extremely high rates',
  },

  // Custom option placeholder
  'custom': {
    id: 'custom',
    utility: 'Custom / Enter Your Own',
    utilityShort: 'Custom',
    state: '',
    region: '',
    isoRto: 'None',
    tariffName: 'Custom Rate Structure',
    rateSchedule: 'Custom',
    effectiveDate: '',
    peakDemandCharge: 9050, // Default
    offPeakDemandCharge: 3000,
    energyRatePeak: 45.0,
    energyRateOffPeak: 32.0,
    blendedRate: 65.0,
    fuelAdjustment: 15.0,
    initialTermYears: 5,
    protectionScore: 0,
    protectionRating: 'Low',
    minimumDemandPct: 0,
    demandRatchetPct: 0,
    takeOrPay: false,
    notes: 'Enter your own utility parameters',
  },
};

/**
 * Get all tariffs as an array sorted by blended rate
 */
export const getAllTariffs = () => {
  return Object.values(CALCULATOR_TARIFFS)
    .filter(t => t.id !== 'custom')
    .sort((a, b) => a.blendedRate - b.blendedRate);
};

/**
 * Get tariffs grouped by ISO/RTO
 */
export const getTariffsByISO = () => {
  const byISO = {};
  Object.values(CALCULATOR_TARIFFS).forEach(tariff => {
    const iso = tariff.isoRto || 'None';
    if (!byISO[iso]) byISO[iso] = [];
    byISO[iso].push(tariff);
  });
  return byISO;
};

/**
 * Get tariffs grouped by region
 */
export const getTariffsByRegion = () => {
  const byRegion = {};
  Object.values(CALCULATOR_TARIFFS).forEach(tariff => {
    if (!tariff.region) return;
    if (!byRegion[tariff.region]) byRegion[tariff.region] = [];
    byRegion[tariff.region].push(tariff);
  });
  // Sort each region by blended rate
  Object.keys(byRegion).forEach(region => {
    byRegion[region].sort((a, b) => a.blendedRate - b.blendedRate);
  });
  return byRegion;
};

/**
 * Get a tariff by ID
 */
export const getTariffById = (id) => {
  return CALCULATOR_TARIFFS[id] || null;
};
